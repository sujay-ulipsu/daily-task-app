<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Daily Work Report</title>

<style>
body{
  font-family:Arial,sans-serif;
  margin:30px;
  color:#000;
}
.logo{text-align:center;margin-bottom:18px;}
.logo img{max-width:150px;}
.header-text{margin-bottom:16px;line-height:1.6;font-size:14px;}
table{width:100%;border-collapse:collapse;table-layout:fixed;margin-top:8px;}
th,td{border:1px solid #000;padding:6px 8px;vertical-align:top;font-size:13px;white-space:pre-wrap;}
th{text-align:center;font-weight:bold;}
col.slno{width:6%;}
col.work{width:32%;}
col.status{width:62%;}
.task-title{font-weight:bold;}
.footer{margin-top:22px;line-height:1.4;font-size:13px;}
.actions{margin-top:15px;}
.actions button{padding:6px 10px;margin-right:8px;font-size:13px;cursor:pointer;}

@media print{
  .actions{display:none !important;}
}
</style>
</head>

<body>

<div class="logo">
  <img src="logo.png" alt="Kidvento Logo">
</div>

<div class="header-text">
  <strong>Dear Kiran,</strong><br>
  Today's Update â€“ <span id="reportDate"></span>
</div>

<table>
<colgroup>
  <col class="slno"><col class="work"><col class="status">
</colgroup>
<thead>
<tr>
  <th>Sl. No.</th>
  <th>Work / Activity</th>
  <th>Status</th>
</tr>
</thead>
<tbody>
<tr><td align="center">1</td><td class="task-title">Tender Master Sheet â€“ Daily Update</td><td id="s1"></td></tr>
<tr><td align="center">2</td><td class="task-title">Internal Team (Logistics & Training Team)</td><td id="s2"></td></tr>
<tr><td align="center">3</td><td class="task-title">DDPI â€“ Follow-ups</td><td id="s3"></td></tr>
<tr><td align="center">4</td><td class="task-title">Other Tasks Completed</td><td id="s4"></td></tr>
<tr><td align="center">5</td><td class="task-title">Pending Tasks</td><td id="s5"></td></tr>
<tr><td align="center">6</td><td class="task-title">Plan for Next Working Day</td><td id="s6"></td></tr>
</tbody>
</table>

<div class="footer">
Regards,<br><br>
<strong>Sujay B V</strong><br>
Manager â€“ Educational Institutions & Operations<br>
Kidvento Education and Research Pvt. Ltd.
</div>

<div class="actions" id="actionButtons">
  <button onclick="printPDF()">Print / Save as PDF</button>
  <button onclick="shareWhatsApp()">Share on WhatsApp</button>
</div>

<script>
/* ===== REPORT DATE (SOURCE OF TRUTH) ===== */
const isoDate =
  localStorage.getItem("currentReportDate") ||
  new Date().toISOString().split("T")[0];

const d = new Date(isoDate);
const dd = String(d.getDate()).padStart(2,"0");
const mm = String(d.getMonth()+1).padStart(2,"0");
const yyyy = d.getFullYear();

const displayDate = `${dd}-${mm}-${yyyy}`;
document.getElementById("reportDate").innerText = displayDate;

/* ===== LOAD DATA ===== */
const data = JSON.parse(
  localStorage.getItem("dailyReport-" + isoDate)
) || {};

for(let i=1;i<=6;i++){
  document.getElementById("s"+i).innerText =
    data["task"+i] || "";
}

/* ===== PDF FILE NAME CONTROL ===== */
const originalTitle = document.title;

function printPDF(){
  const actions = document.getElementById("actionButtons");
  actions.style.display = "none";

  // ðŸ”¥ THIS decides the PDF filename
  document.title = `Daily_Update_${displayDate}`;

  window.print();

  setTimeout(()=>{
    document.title = originalTitle;
    actions.style.display = "block";
  },500);
}

function shareWhatsApp(){
  window.open(
    "https://wa.me/?text=" +
    encodeURIComponent(document.body.innerText),
    "_blank"
  );
}
</script>

</body>
</html>